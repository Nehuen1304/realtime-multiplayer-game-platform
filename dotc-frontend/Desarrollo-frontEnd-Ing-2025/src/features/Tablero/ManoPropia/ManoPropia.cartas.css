/*  CARTAS EN MANO PROPIA  */

/* Wrapper principal de las cartas en la mano */
.cartas-wrapper {
    display: flex;
    justify-content: center;
    gap: 0;
    position: relative;
    max-width: 80vw;
    min-height: var(--card-height, 4rem);
}

/* Cuando el jugador ya jugó, deshabilito las cartas visualmente */
.cartas-wrapper.disabled {
    opacity: 0.6;
    /* pointer-events: none; */
}

/* Durante la ventana NSF, las cartas están habilitadas */
.cartas-wrapper[data-nsf-active="true"] {
    opacity: 1;
}

.cartas-wrapper[data-nsf-active="true"] .carta-visual {
    cursor: pointer;
    transition: transform 200ms ease, box-shadow 200ms ease;
}

.cartas-wrapper[data-nsf-active="true"] .carta-visual:hover {
    transform: translateY(-8px) scale(1.05);
    box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
    z-index: 10;
}

/* Cada carta individual en la mano */
.cartas-wrapper .carta-visual {
    margin-right: 1rem; /* Espacio entre cartas */
    position: relative;
    z-index: 1;
    cursor: pointer; /* Añadido: cursor pointer siempre */
    transition:
        transform 500ms cubic-bezier(.22, 1, .36, 1),
        box-shadow 220ms cubic-bezier(.22, 1, .36, 1),
        opacity 180ms;
    will-change: transform, opacity;
}

/* Cuando el wrapper está deshabilitado, cursor default */
.cartas-wrapper.disabled .carta-visual {
    cursor: default;
}

/* Cuando hago hover sobre una carta, la traigo al frente y la hago más visible */
.cartas-wrapper .carta-visual:hover {
    z-index: 20;
    opacity: 1;
}

/* Cuando paso el mouse por encima del wrapper, las cartas se ponen opacas menos la que está bajo el mouse */
.cartas-wrapper:hover .carta-visual {
    opacity: 0.2;
}

/* Equivalente para mobile cuando hay "hover táctil" activo */
.cartas-wrapper[data-hovered="true"] .carta-visual {
    opacity: 0.2;
}

/* La carta que está bajo el mouse se agranda y se resalta */
.cartas-wrapper[data-hovered="true"] .carta-visual[data-diff="0"] {
    transform: translateY(-18px) scale(1.80) rotate(-2deg);
    z-index: 50;
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.8), 0 0 40px rgba(240, 230, 210, 0.18);
    opacity: 1;
}


/* Las cartas adyacentes a la seleccionada se acercan y se ven menos opacas */
.cartas-wrapper[data-hovered="true"] .carta-visual[data-diff="1"],
.cartas-wrapper[data-hovered="true"] .carta-visual[data-diff="-1"] {
    z-index: 40;
    opacity: 0.95;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.5);
}

/* Variable para saber si la carta está a la derecha o izquierda de la seleccionada */
.cartas-wrapper[data-hovered="true"] .carta-visual[data-diff="1"] { --sign: 1; }
.cartas-wrapper[data-hovered="true"] .carta-visual[data-diff="-1"] { --sign: -1; }

/* Las cartas más alejadas se ven más opacas y no se mueven */
.cartas-wrapper[data-hovered="true"] .carta-visual[data-diff="2"]:not(.selected),
.cartas-wrapper[data-hovered="true"] .carta-visual[data-diff="-2"]:not(.selected) {
    opacity: 0.5;
    z-index: 1;
}

/* --- MODO PORTRAIT: Las cartas se superponen más y los adyacentes se apartan más --- */
@media (orientation: portrait) {
    /* Superpongo las cartas para ahorrar espacio en vertical */
    .cartas-wrapper .carta-visual:not(:last-child) {
        margin-right: calc(-0.5 * var(--overlap));
    }

    /* Cuando hago hover, las adyacentes se apartan horizontalmente */
    .cartas-wrapper[data-hovered="true"] .carta-visual[data-diff="1"],
    .cartas-wrapper[data-hovered="true"] .carta-visual[data-diff="-1"] {
        transform: translateY(-8px) scale(1.03) translateX(calc(var(--step) * var(--sign, 1)));
    }
}

@media (max-width: 768px) {
    /* Superpongo las cartas para ahorrar espacio en vertical */
    .cartas-wrapper .carta-visual:not(:last-child) {
        margin-right: calc(-0.8 * var(--overlap));
    }
}

/* SELECCIÓN DE CARTA: Ajusta la escala y agrega rotación para transicionar suavemente desde hover */
.cartas-wrapper .carta-visual.selected {
    outline: none;
    transform: translateY(-15px) scale(1.06) rotate(-1deg);
    opacity: 1;
    /* z-index: 10; */
    box-shadow: 0 6px 12px rgba(255, 255, 255, 0.8), 0 0 20px rgba(255, 215, 0, 0.4), 0 0 20px rgba(255, 215, 0, 0.2) !important;
    /* transición explícita (coincide con la de Carta.css) */
    transition: transform 320ms cubic-bezier(0.22, 1, 0.36, 1), box-shadow 320ms cubic-bezier(0.22, 1, 0.36, 1), opacity 180ms;
    will-change: transform, opacity;
    animation: selectedGlow 1.5s ease-in-out infinite alternate !important;
}

/* @media (hover: none) and (pointer: coarse) {
  .cartas-wrapper {
    touch-action: pan-y;
    -webkit-user-select: none;
    user-select: none;
  }
} */

@media (hover: none) and (pointer: coarse) {
  .cartas-wrapper {
    touch-action: pan-x;          /* sólo deslizamiento horizontal */
    overscroll-behavior-y: contain; /* evita que se encadene el scroll al viewport */
    -webkit-user-select: none;
    user-select: none;
  }

  /* Durante el "hold"/hover táctil, bloquear todo el scroll/pan */
  .cartas-wrapper[data-hovered="true"] {
    touch-action: none;
  }
}